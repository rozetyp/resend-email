<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Resend Pad ‚Äì Free Resend Email Editor (BYO API Key)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Send one-off emails with Resend from your browser. No code, no accounts, no storage. Paste your API key, compose, send." />
  <meta name="keywords" content="Resend email, free email editor, BYOK email, send email without code, Resend API tool" />
  <meta property="og:title" content="Resend Pad ‚Äì Free Email Editor for Resend" />
  <meta property="og:description" content="Send emails with Resend using your own API key. Simple. Trustworthy. Works everywhere." />
  <meta property="og:type" content="website" />
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Pell Rich Text Editor CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pell@1.0.2/dist/pell.min.css" />
  <!-- Google Analytics (placeholder) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    // gtag('config', 'G-XXXXXXXXXX');
  </script>
  
  <style>
    /* Pell editor custom styling */
    .pell-content {
      outline: 0;
      min-height: 250px;
      padding: 0.75rem;
      background-color: #ffffff;
      color: #111827;
      border: 1px solid #d1d5db;
      border-top: 0;
      border-bottom-left-radius: 0.5rem;
      border-bottom-right-radius: 0.5rem;
      line-height: 1.6;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }
    
    .pell-actionbar {
      background-color: #f9fafb;
      border: 1px solid #d1d5db;
      border-bottom: 1px solid #e5e7eb;
      border-top-left-radius: 0.5rem;
      border-top-right-radius: 0.5rem;
      padding: 0.25rem;
    }
    
    .pell-button {
      color: #374151;
      border-radius: 0.375rem;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    
    .pell-button:hover {
      background-color: #e5e7eb;
    }
    
    .pell-button-selected {
      background-color: #dbeafe;
      color: #1e40af;
    }

    #preview_content h1 { font-size: 1.875rem; font-weight: 600; margin-bottom: 0.5rem; }
    #preview_content h2 { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.5rem; }
    #preview_content p { margin-bottom: 1rem; }
    #preview_content ul { list-style-type: disc; margin-left: 1.5rem; margin-bottom: 1rem; }
    #preview_content ol { list-style-type: decimal; margin-left: 1.5rem; margin-bottom: 1rem; }
    #preview_content a { color: #2563eb; text-decoration: underline; }
    #preview_content pre { background-color: #f3f4f6; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; }

    /* Stripe-inspired minimalist design */
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    .hero-divider { background: linear-gradient(to bottom, #ffffff 0%, #f9fafb 100%); }
  </style>
</head>

<body class="bg-white text-gray-900">
  <!-- ============ HEADER ============ -->
  <div class="border-b border-gray-200">
    <div class="max-w-4xl mx-auto px-4 sm:px-8 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <h1 class="text-xl font-bold">Resend Pad</h1>
        <a href="https://github.com/rozetyp/resend-email" target="_blank" rel="noopener noreferrer" title="View on GitHub" class="text-gray-400 hover:text-gray-600">
          <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.108-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.085 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
        </a>
      </div>
      <a href="#editor" class="text-sm text-gray-600 hover:text-gray-900 font-medium">Editor ‚Üì</a>
    </div>
  </div>

  <!-- ============ HERO ============ -->
  <div class="hero-divider py-16 sm:py-20 px-4 sm:px-8">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-4 leading-tight">
        Send Resend emails<br/>from your browser
      </h2>
      <p class="text-lg text-gray-600 mb-10">
        No code. No accounts. No storage.<br/>
        Paste your API key, compose, send.
      </p>
      
      <!-- Trust Signals -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-6 sm:gap-8 mb-12">
        <div>
          <div class="text-3xl font-light text-gray-300 mb-2">‚úì</div>
          <p class="text-sm text-gray-600"><strong>Bring Your Own Key</strong><br/>Just proxy your calls to Resend</p>
        </div>
        <div>
          <div class="text-3xl font-light text-gray-300 mb-2">‚úì</div>
          <p class="text-sm text-gray-600"><strong>No Storage</strong><br/>No accounts, DB, or logging</p>
        </div>
        <div>
          <div class="text-3xl font-light text-gray-300 mb-2">‚úì</div>
          <p class="text-sm text-gray-600"><strong>Open Source</strong><br/>Audit or self-host freely</p>
        </div>
      </div>

      <a href="#editor" class="inline-block px-7 py-3 bg-gray-900 text-white font-medium rounded-lg hover:bg-gray-800 transition-colors">
        Open Editor
      </a>
    </div>
  </div>

  <!-- ============ HOW IT WORKS ============ -->
  <div class="bg-gray-50 border-b border-gray-200 py-16 px-4 sm:px-8">
    <div class="max-w-4xl mx-auto">
      <h3 class="text-2xl font-bold text-gray-900 mb-12 text-center">How It Works</h3>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-8 mb-10">
        <div class="text-center">
          <div class="text-5xl font-light text-gray-200 mb-3">1</div>
          <p class="font-medium text-gray-900 mb-2">Paste Your Key</p>
          <p class="text-sm text-gray-600">Enter your Resend API key (session-only, never stored)</p>
        </div>
        <div class="text-center">
          <div class="text-5xl font-light text-gray-200 mb-3">2</div>
          <p class="font-medium text-gray-900 mb-2">Compose</p>
          <p class="text-sm text-gray-600">Fill To, From, Subject, and body with our editor</p>
        </div>
        <div class="text-center">
          <div class="text-5xl font-light text-gray-200 mb-3">3</div>
          <p class="font-medium text-gray-900 mb-2">Send</p>
          <p class="text-sm text-gray-600">Click send. We proxy to Resend. Email delivered.</p>
        </div>
      </div>
      
      <!-- Flow Diagram -->
      <div class="bg-white border border-gray-200 rounded-lg p-6">
        <code class="text-xs text-gray-600 font-mono block text-center">
          Your Key ‚Üí Resend Pad ‚Üí Resend API ‚Üí ‚úì Sent
        </code>
      </div>
    </div>
  </div>

  <!-- ============ EDITOR (MAIN FORM) ============ -->
  <div id="editor" class="py-16 px-4 sm:px-8 scroll-mt-20">
    <div class="max-w-2xl mx-auto">
      <form id="send_form">
        
        <!-- API KEY INPUT -->
        <div class="mb-6">
          <label for="api_key" class="block mb-2 text-sm font-medium text-gray-900">Your Resend API Key</label>
          <input 
            type="password" 
            id="api_key" 
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"
            placeholder="re_xxxxxxxxxxxxxxxxxxxxx" 
            style="font-family: 'Courier New', monospace; font-size: 0.875rem;"
            required
          />
          <p class="mt-2 text-xs text-gray-600">
            üîí Your key is only used in your browser. It's sent directly to Resend's API and never stored on our server.
          </p>
        </div>

        <!-- LOAD DOMAINS BUTTON -->
        <div class="mb-6">
          <button 
            type="button" 
            id="load_domains_btn" 
            class="w-full px-4 py-2 text-sm font-medium text-white bg-gray-600 rounded-lg hover:bg-gray-700 transition-colors"
          >
            Load Verified Domains
          </button>
          <p class="mt-2 text-xs text-gray-600">Optional: Click to auto-populate "From" with your verified domains</p>
        </div>

        <!-- MESSAGE CONTAINER (for domain loading / errors) -->
        <div id="messageContainer"></div>

        <!-- FROM INPUT -->
        <div class="mb-6">
          <label for="from" class="block mb-2 text-sm font-medium text-gray-900">From (Email)</label>
          <input 
            type="email" 
            id="from" 
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"
            placeholder="noreply@example.com" 
            required
          />
          <p class="mt-2 text-xs text-gray-600">Must be verified in your Resend account</p>
        </div>

        <!-- TO INPUT -->
        <div class="mb-6">
          <label for="to" class="block mb-2 text-sm font-medium text-gray-900">To (Email)</label>
          <input 
            type="email" 
            id="to" 
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"
            placeholder="recipient@example.com" 
            required
          />
        </div>

        <!-- SUBJECT INPUT -->
        <div class="mb-6">
          <label for="subject" class="block mb-2 text-sm font-medium text-gray-900">Subject</label>
          <input 
            type="text" 
            id="subject" 
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"
            placeholder="Hello from Resend Pad!" 
            required
          />
        </div>

        <!-- BODY (PELL EDITOR) -->
        <div class="mb-6">
          <label class="block mb-2 text-sm font-medium text-gray-900">Email Body (Rich Text)</label>
          <div id="pell"></div>
          <textarea 
            id="body_textarea" 
            style="display:none;"
            required
          ></textarea>
        </div>

        <!-- PREVIEW TOGGLE -->
        <div class="mb-6">
          <button 
            type="button" 
            id="preview_btn" 
            class="text-sm font-medium text-blue-600 hover:text-blue-700 underline"
          >
            Preview Email
          </button>
        </div>

        <!-- PREVIEW MODAL -->
        <div id="preview_modal" style="display:none;" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
          <div class="bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-96 overflow-y-auto">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
              <h4 class="font-bold text-gray-900">Email Preview</h4>
              <button type="button" id="preview_close_btn" class="text-gray-600 hover:text-gray-900 text-2xl">&times;</button>
            </div>
            <div id="preview_content" class="p-6"></div>
          </div>
        </div>

        <!-- SEND BUTTON -->
        <button 
          type="submit" 
          id="send_btn" 
          class="w-full px-4 py-3 bg-gray-900 text-white font-medium rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
        >
          Send Email
        </button>
      </form>
    </div>
  </div>

  <!-- ============ SECURITY & FAQ ============ -->
  <div class="bg-gray-50 border-t border-gray-200 py-16 px-4 sm:px-8">
    <div class="max-w-2xl mx-auto">
      <h3 class="text-2xl font-bold text-gray-900 mb-8">Security & Trust</h3>
      
      <div class="space-y-6">
        <div>
          <h4 class="font-medium text-gray-900 mb-2">Do you store my API key?</h4>
          <p class="text-sm text-gray-600">No. Your key is only used in the Authorization header when sending to Resend and is never persisted in logs or a database.</p>
        </div>
        
        <div>
          <h4 class="font-medium text-gray-900 mb-2">Do you store my emails?</h4>
          <p class="text-sm text-gray-600">No. There is no database. Email bodies are forwarded to Resend and discarded after the request is completed.</p>
        </div>
        
        <div>
          <h4 class="font-medium text-gray-900 mb-2">Can I self-host this?</h4>
          <p class="text-sm text-gray-600">Yes. It's a single Node.js proxy + HTML file. Deploy to Railway, Vercel, or your own server. <a href="https://github.com/rozetyp/resend-email" class="text-blue-600 hover:underline">View on GitHub</a>.</p>
        </div>
        
        <div>
          <h4 class="font-medium text-gray-900 mb-2">Can I use this for production?</h4>
          <p class="text-sm text-gray-600">Yes, but you're responsible for domain setup (SPF/DKIM) and compliance with anti-spam policies and Resend's terms.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ FOOTER ============ -->
  <div class="border-t border-gray-200 py-8 px-4 sm:px-8 text-center text-xs text-gray-600">
    <p>
      Made by 
      <a href="mailto:rozetyp@gmail.com" class="text-blue-600 hover:underline">rozetyp</a>
      ¬∑ 
      <a href="https://github.com/rozetyp/resend-email" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">GitHub</a>
      ¬∑ 
      <a href="https://buymeacoffee.com/sandbar" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline">Buy Me a Coffee</a>
    </p>
    <p class="mt-3 text-gray-500">Not affiliated with or endorsed by Resend, Inc.</p>
  </div>

  <!-- ============ SCRIPTS ============ -->
  <script src="https://cdn.jsdelivr.net/npm/pell@1.0.2/dist/pell.min.js"></script>
  <script>
    // ============ ENVIRONMENT SETUP ============
    const API_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
      ? 'http://localhost:3001'
      : `https://${window.location.host}`;

    console.log('Environment:', API_URL);

    // ============ PELL EDITOR INITIALIZATION ============
    const pellEditorConfig = {
      element: document.getElementById('pell'),
      onChange: (html) => {
        document.getElementById('body_textarea').value = html;
        console.log('Pell content updated:', html.substring(0, 50) + '...');
      }
    };

    try {
      pell.init(pellEditorConfig);
      console.log('Pell editor initialized successfully');
    } catch (error) {
      console.error('Failed to initialize Pell editor:', error);
    }

    // ============ DOMAIN LOADING ============
    document.getElementById('load_domains_btn')?.addEventListener('click', async (e) => {
      e.preventDefault();
      const apiKey = document.getElementById('api_key').value;
      const messageContainer = document.getElementById('messageContainer');

      if (!apiKey.trim()) {
        messageContainer.innerHTML = '<div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50">Please enter your API key first.</div>';
        return;
      }

      try {
        console.log('Fetching domains...');
        const response = await fetch(`${API_URL}/api/domains`, {
          headers: { 'Authorization': `Bearer ${apiKey}` }
        });

        const data = await response.json();
        console.log('Domains response:', data);

        if (!response.ok) {
          throw new Error(data.message || 'Failed to load domains');
        }

        if (data.data && data.data.length > 0) {
          const domains = data.data.map(d => d.name).join(', ');
          messageContainer.innerHTML = `<div class="p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50">‚úì Domains loaded: <strong>${domains}</strong></div>`;
          document.getElementById('from').placeholder = data.data[0].name;
        } else {
          messageContainer.innerHTML = '<div class="p-4 mb-4 text-sm text-yellow-800 rounded-lg bg-yellow-50">No verified domains found. <a href="https://resend.com/domains" class="underline">Add one in Resend</a>.</div>';
        }
      } catch (error) {
        console.error('Domain fetch error:', error);
        messageContainer.innerHTML = `<div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50"><strong>Error:</strong> ${error.message}</div>`;
      }
    });

    // ============ PREVIEW FUNCTIONALITY ============
    document.getElementById('preview_btn')?.addEventListener('click', (e) => {
      e.preventDefault();
      const body = document.getElementById('body_textarea').value;
      document.getElementById('preview_content').innerHTML = body || '<p class="text-gray-500">No content yet.</p>';
      document.getElementById('preview_modal').style.display = 'flex';
    });

    document.getElementById('preview_close_btn')?.addEventListener('click', () => {
      document.getElementById('preview_modal').style.display = 'none';
    });

    // ============ FORM SUBMISSION ============
    const form = document.getElementById('send_form');
    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const apiKey = document.getElementById('api_key').value.trim();
      const from = document.getElementById('from').value.trim();
      const to = document.getElementById('to').value.trim();
      const subject = document.getElementById('subject').value.trim();
      const body = document.getElementById('body_textarea').value.trim();
      const messageContainer = document.getElementById('messageContainer');
      const sendBtn = document.getElementById('send_btn');

      if (!apiKey || !from || !to || !subject || !body) {
        messageContainer.innerHTML = '<div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50">All fields are required.</div>';
        return;
      }

      sendBtn.disabled = true;
      sendBtn.textContent = 'Sending...';

      try {
        const payload = { from, to: [to], subject, html: body };
        console.log('Sending to Resend API...', payload);

        const response = await fetch(`${API_URL}/api/send`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${apiKey}`,
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(payload)
        });

        const data = await response.json();

        if (!response.ok) {
          const errorMsg = data.message || 'An unknown error occurred.';
          throw new Error(`API Error (${data.name}): ${errorMsg}`);
        }

        messageContainer.innerHTML = `
          <div class="p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50">
            <span class="font-medium">‚úì Email Sent Successfully!</span>
            <div class="mt-2 p-3 bg-green-100 rounded font-mono text-xs">
              <div><strong>Email ID:</strong> ${data.id}</div>
              <div class="mt-1"><strong>To:</strong> ${to}</div>
            </div>
          </div>
        `;
      } catch (error) {
        let errorMsg = error.message;
        if (errorMsg.includes('401')) errorMsg += ' ‚Üí Check your API key at <a href="https://resend.com/api-keys" class="underline">resend.com/api-keys</a>';
        if (errorMsg.includes('from')) errorMsg += ' ‚Üí "From" must be verified in Resend';

        messageContainer.innerHTML = `
          <div class="p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50">
            <span class="font-medium">‚ùå Send Failed:</span>
            <div class="mt-1 text-xs">${errorMsg}</div>
            <div class="mt-2 text-xs text-gray-600">Debug: Check F12 console for details.</div>
          </div>
        `;
      } finally {
        sendBtn.disabled = false;
        sendBtn.textContent = 'Send Email';
      }
    });
  </script>
</body>
</html>
